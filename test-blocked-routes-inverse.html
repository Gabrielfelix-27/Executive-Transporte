<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste - L√≥gica Inversa de Bloqueio de Rotas</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #fafafa;
        }
        .test-case {
            margin: 15px 0;
            padding: 15px;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .blocked {
            background-color: #ffebee;
            border-left: 4px solid #f44336;
        }
        .allowed {
            background-color: #e8f5e8;
            border-left: 4px solid #4caf50;
        }
        .route {
            font-weight: bold;
        }
        .result {
            padding: 5px 15px;
            border-radius: 20px;
            color: white;
            font-weight: bold;
        }
        .result.blocked {
            background-color: #f44336;
        }
        .result.allowed {
            background-color: #4caf50;
        }
        .legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 20px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üö´ Teste - L√≥gica Inversa de Bloqueio de Rotas</h1>
        
        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background-color: #f44336;"></div>
                <span>Rota Bloqueada</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background-color: #4caf50;"></div>
                <span>Rota Permitida</span>
            </div>
        </div>

        <div class="test-section">
            <h2>üîÑ NOVA L√ìGICA INVERSA: Outros Estados ‚Üí S√£o Paulo</h2>
            <p><strong>Objetivo:</strong> Bloquear rotas vindas de outros estados com destino a S√£o Paulo</p>
            
            <div id="inverse-tests"></div>
        </div>

        <div class="test-section">
            <h2>üìç L√ìGICA ORIGINAL: S√£o Paulo ‚Üî Viracopos/Sorocaba</h2>
            <p><strong>Objetivo:</strong> Manter bloqueios existentes para Viracopos e Sorocaba</p>
            
            <div id="original-tests"></div>
        </div>

        <div class="test-section">
            <h2>‚úÖ ROTAS PERMITIDAS: Dentro de S√£o Paulo</h2>
            <p><strong>Objetivo:</strong> Garantir que rotas internas de SP continuem funcionando</p>
            
            <div id="allowed-tests"></div>
        </div>
    </div>

    <script type="module">
        // Simula√ß√£o da fun√ß√£o isBlockedRoute (copiada da implementa√ß√£o)
        function isBlockedRoute(origin, destination) {
            const originLower = origin.toLowerCase().trim();
            const destinationLower = destination.toLowerCase().trim();

            // Fun√ß√£o para detectar se √© S√£o Paulo
            const isSaoPauloRegion = (address) => {
                const spKeywords = [
                    's√£o paulo', 'sao paulo', 'sp',
                    'centro', 'rep√∫blica', 's√©', 'liberdade', 'bela vista',
                    'consola√ß√£o', 'higien√≥polis', 'santa cec√≠lia', 'campos el√≠seos',
                    'bom retiro', 'luz', 'br√°s', 'pari', 'canind√©',
                    'vila guilherme', 'santana', 'tucuruvi', 'ja√ßan√£',
                    'zona norte', 'zona sul', 'zona leste', 'zona oeste',
                    'paulista', 'avenida paulista', 'itaim', 'itaim bibi',
                    'vila ol√≠mpia', 'vila olimpia', 'pinheiros', 'lapa',
                    'perdizes', 'pompeia', 'barra funda', 'agua branca',
                    'vila leopoldina', 'jaguare', 'rio pequeno', 'raposo tavares',
                    'butanta', 'butant√£', 'morumbi', 'vila sonia', 'jardim paulista',
                    'vila mariana', 'saude', 'sa√∫de', 'cursino', 'ipiranga',
                    'sacoma', 'jabaquara', 'cidade ademar', 'pedreira',
                    'cidade dutra', 'socorro', 'cidade tiradentes', 'graja√∫',
                    'parelheiros', 'mooca', 'tatuape', 'tatuap√©', 'penha',
                    'vila formosa', 'vila matilde', 'vila prudente', 'sapopemba',
                    'vila carr√£o', 'aricanduva', 'itaquera', 'guaianases',
                    'lajeado', 'itaim paulista', 'jardins', 'cerqueira cesar',
                    'cerqueira c√©sar', 'para√≠so', 'paraiso', 'aclima√ß√£o',
                    'cambuci', 'vila madalena', 'sumar√©', 'sumare'
                ];

                const spCepPatterns = [
                    /\b0[1-5]\d{3}-?\d{3}\b/,
                    /\b08[0-4]\d{2}-?\d{3}\b/
                ];

                const hasSpKeyword = spKeywords.some(keyword => address.includes(keyword));
                const hasSpCep = spCepPatterns.some(pattern => pattern.test(address));

                return hasSpKeyword || hasSpCep;
            };

            // Fun√ß√£o para detectar Viracopos/Campinas
            const isViracoposCampinas = (address) => {
                const viracoposKeywords = [
                    'viracopos', 'vcp', 'aeroporto viracopos',
                    'campinas', 'santos dumont', 'rod. santos dumont'
                ];
                const viracoposCepPattern = /\b13052-?\d{3}\b/;
                const hasViracoposKeyword = viracoposKeywords.some(keyword => address.includes(keyword));
                const hasViracoposCep = viracoposCepPattern.test(address);
                return hasViracoposKeyword || hasViracoposCep;
            };

            // Fun√ß√£o para detectar Sorocaba
            const isSorocaba = (address) => {
                const sorocabaKeywords = ['sorocaba', 'sorocaba sp'];
                const sorocabaCepPattern = /\b18\d{3}-?\d{3}\b/;
                const hasSorocabaKeyword = sorocabaKeywords.some(keyword => address.includes(keyword));
                const hasSorocabaCep = sorocabaCepPattern.test(address);
                return hasSorocabaKeyword || hasSorocabaCep;
            };

            // Fun√ß√£o para detectar outros estados
            const isOutOfSaoPauloState = (address) => {
                const otherStatesKeywords = [
                    'rio de janeiro', 'rj', 'copacabana', 'ipanema', 'barra da tijuca',
                    'minas gerais', 'mg', 'belo horizonte', 'uberl√¢ndia',
                    'paran√°', 'pr', 'curitiba', 'londrina', 'maring√°',
                    'rio grande do sul', 'rs', 'porto alegre', 'caxias do sul',
                    'santa catarina', 'sc', 'florian√≥polis', 'joinville',
                    'bahia', 'ba', 'salvador', 'feira de santana',
                    'goi√°s', 'go', 'goi√¢nia', 'aparecida de goi√¢nia',
                    'esp√≠rito santo', 'es', 'vit√≥ria', 'vila velha',
                    'distrito federal', 'df', 'bras√≠lia', 'brasilia'
                ];

                const otherStatesCepPatterns = [
                    /\b2[0-8]\d{3}-?\d{3}\b/, // RJ
                    /\b3[0-9]\d{3}-?\d{3}\b/, // MG
                    /\b8[0-7]\d{3}-?\d{3}\b/, // PR
                    /\b9[0-9]\d{3}-?\d{3}\b/, // RS
                    /\b8[8-9]\d{3}-?\d{3}\b/, // SC
                    /\b4[0-8]\d{3}-?\d{3}\b/, // BA
                    /\b7[2-7]\d{3}-?\d{3}\b/, // GO
                    /\b2[9]\d{3}-?\d{3}\b/,   // ES
                    /\b7[0-1]\d{3}-?\d{3}\b/  // DF
                ];

                const hasOtherStateKeyword = otherStatesKeywords.some(keyword => address.includes(keyword));
                const hasOtherStateCep = otherStatesCepPatterns.some(pattern => pattern.test(address));

                return hasOtherStateKeyword || hasOtherStateCep;
            };

            // L√ìGICA ORIGINAL
            if (isSaoPauloRegion(originLower) && isViracoposCampinas(destinationLower)) return true;
            if (isSaoPauloRegion(originLower) && isSorocaba(destinationLower)) return true;
            if (isViracoposCampinas(originLower) && isSaoPauloRegion(destinationLower)) return true;
            if (isSorocaba(originLower) && isSaoPauloRegion(destinationLower)) return true;

            // NOVA L√ìGICA INVERSA
            if (isOutOfSaoPauloState(originLower) && isSaoPauloRegion(destinationLower)) return true;

            return false;
        }

        // Casos de teste para NOVA L√ìGICA INVERSA
        const inverseTestCases = [
            { origin: "Rio de Janeiro, RJ", destination: "S√£o Paulo, SP", expected: true },
            { origin: "Copacabana, Rio de Janeiro", destination: "Vila Ol√≠mpia, S√£o Paulo", expected: true },
            { origin: "Belo Horizonte, MG", destination: "Paulista, S√£o Paulo", expected: true },
            { origin: "Curitiba, PR", destination: "Centro, S√£o Paulo", expected: true },
            { origin: "Porto Alegre, RS", destination: "Itaim Bibi, SP", expected: true },
            { origin: "Florian√≥polis, SC", destination: "Pinheiros, S√£o Paulo", expected: true },
            { origin: "Salvador, BA", destination: "Vila Madalena, SP", expected: true },
            { origin: "Goi√¢nia, GO", destination: "Mooca, S√£o Paulo", expected: true },
            { origin: "Bras√≠lia, DF", destination: "Tatuap√©, S√£o Paulo", expected: true },
            { origin: "Vit√≥ria, ES", destination: "Liberdade, SP", expected: true },
            { origin: "22070-900", destination: "01310-100", expected: true }, // RJ ‚Üí SP (CEPs)
            { origin: "30112-000", destination: "04038-001", expected: true }  // MG ‚Üí SP (CEPs)
        ];

        // Casos de teste para L√ìGICA ORIGINAL
        const originalTestCases = [
            { origin: "S√£o Paulo, SP", destination: "Viracopos, Campinas", expected: true },
            { origin: "Vila Ol√≠mpia, SP", destination: "Aeroporto Viracopos", expected: true },
            { origin: "S√£o Paulo, SP", destination: "Sorocaba, SP", expected: true },
            { origin: "Viracopos", destination: "S√£o Paulo, SP", expected: true },
            { origin: "Sorocaba", destination: "Centro, S√£o Paulo", expected: true }
        ];

        // Casos de teste para ROTAS PERMITIDAS
        const allowedTestCases = [
            { origin: "Vila Ol√≠mpia, S√£o Paulo", destination: "Itaim Bibi, S√£o Paulo", expected: false },
            { origin: "Centro, SP", destination: "Pinheiros, SP", expected: false },
            { origin: "Paulista, S√£o Paulo", destination: "Vila Madalena, SP", expected: false },
            { origin: "Mooca, SP", destination: "Tatuap√©, S√£o Paulo", expected: false },
            { origin: "01310-100", destination: "04038-001", expected: false } // SP ‚Üí SP (CEPs)
        ];

        function renderTestCases(testCases, containerId, sectionTitle) {
            const container = document.getElementById(containerId);
            
            testCases.forEach(testCase => {
                const result = isBlockedRoute(testCase.origin, testCase.destination);
                const isCorrect = result === testCase.expected;
                
                const div = document.createElement('div');
                div.className = `test-case ${result ? 'blocked' : 'allowed'}`;
                
                div.innerHTML = `
                    <div class="route">
                        <strong>De:</strong> ${testCase.origin} 
                        <strong>‚Üí Para:</strong> ${testCase.destination}
                    </div>
                    <div class="result ${result ? 'blocked' : 'allowed'}">
                        ${result ? 'üö´ BLOQUEADA' : '‚úÖ PERMITIDA'}
                        ${isCorrect ? '' : ' ‚ùå ERRO!'}
                    </div>
                `;
                
                container.appendChild(div);
            });
        }

        // Renderizar todos os testes
        renderTestCases(inverseTestCases, 'inverse-tests', 'L√≥gica Inversa');
        renderTestCases(originalTestCases, 'original-tests', 'L√≥gica Original');
        renderTestCases(allowedTestCases, 'allowed-tests', 'Rotas Permitidas');

        console.log('üß™ Testes de L√≥gica Inversa de Bloqueio executados!');
    </script>
</body>
</html>